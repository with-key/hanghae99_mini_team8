{% extends 'base_account.html' %}

{% block title %}íšŒì›ê°€ì…{% endblock %}

{% block content %}
<section class="account-section">
    <img src="../static/images/logo.png" alt="" class="logo-account">
    <div class="wrapper wrapper_sign_up ">
        <!-- <h1 class="title">í™˜ì˜í•©ë‹ˆë‹¤ ğŸ‘‹</h1> -->
        
        <div class="form-group row double-check">
            <label for="id" class="col-sm-3 col-form-label">ì•„ì´ë””</label>
            <div class="col-sm-9">
                <input type="text" name="id" class="form-control" id="userid" onkeyup="submitValid()">
                <div class="help_msg"></div>
                <button class="btn btn-primary" id="valid_btn" onclick="validUserId()">ì¤‘ë³µí™•ì¸</button>
            </div>
        </div>
        <div class="form-group row">
            <label for="name" class="col-sm-3 col-form-label">ì´ë¦„</label>
            <div class="col-sm-9">
                <input type="text" name="name" class="form-control" id="username">
            </div>
        </div>
        <div class="form-group row">
            <label for=" password" class="col-sm-3 col-form-label">ë¹„ë°€ë²ˆí˜¸</label>
            <div class="col-sm-9">
                <input type="password" name="password" class="form-control" id="userpw">
            </div>
        </div>
        <div class="form-group row">
            <label for=" password" class="col-sm-3 col-form-label">ë¹„ë°€ë²ˆí˜¸ í™•ì¸</label>
            <div class="col-sm-9">
                <input type="password" name="password" class="form-control" id="userRePw" onkeyup="validPw()">
                <div id="help_msg" class="validation-message"></div>
            </div>
        </div>
        <div class="sign_up_btn_set">
            <a href="/main" class="btn btn-lg btn-outline-secondary">ì´ì „</a>
            <button class="btn btn-lg btn-primary" onclick="getSignup()" id="submit_btn" disabled>ì™„ë£Œ</button>
        </div>
    </div>
</section>

<!-- script -->
<script>
    //  íšŒì›ê°€ì… ì™„ë£Œ
    function getSignup() {
        $.ajax({
            type: 'POST',
            url: '/signup',
            data: {
                id: $('#userid').val(),
                pw: $('#userpw').val(),
                name: $('#username').val(),
            },
            success: function (res) {
                if (res['result'] == 'success') {
                    alert('íšŒì›ê°€ì…ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤.');
                    window.location.replace("/main")
                } else {
                    alert('ì¤‘ë³µëœ ì•„ì´ë””ì…ë‹ˆë‹¤!');
                }
            },
        });
    }
    function validUserId() {
        $.ajax({
            type: 'POST',
            url: '/signup/check_dup',
            data: {
                id: $('#userid').val(),
            },
            success: function (res) {
                if (res.exists === true) {
                    alert("ì´ë¯¸ ì¡´ì¬í•˜ëŠ” ì•„ì´ë””ì…ë‹ˆë‹¤.")
                    document.getElementById('userid').value = "";
                } else {
                    alert("ì‚¬ìš©ê°€ëŠ¥í•œ ì•„ì´ë””ì…ë‹ˆë‹¤")
                }
            },
        });
    }



    // ë¹„ë°€ë²ˆí˜¸ ìœ íš¨ì„± ì²´í¬
    const validPw = () => {
        const pw = document.getElementById('userpw').value
        const rePw = document.getElementById('userRePw').value
        const submitBtn = document.getElementById('submit_btn')
        const msg = document.getElementById('help_msg')

        if (pw !== rePw) {
            msg.innerText = "ë¹„ë°€ë²ˆí˜¸ê°€ ì¼ì¹˜í•˜ì§€ ì•Šì•„ìš” ğŸ¤”"
            msg.style.color = "coral"
            submitBtn.disabled = true
            submitBtn.style.backgroundColor = "#ddd"

        }
        if (pw === rePw) {
            msg.innerText = "ë¹„ë°€ë²ˆí˜¸ê°€ ì¼ì¹˜í•©ë‹ˆë‹¤ ğŸ‘"
            submitBtn.disabled = false
            submitBtn.style.backgroundColor = "#D2302C"
        }
    }

    const submitValid = () => {
        const id = document.getElementById('userid').value
        const name = document.getElementById('username').value
        const submitBtn = document.getElementById('submit_btn')

        if (id !== "" && name !== "") {
            submitBtn.disabled = false
            submitBtn.style.backgroundColor = "#D2302C"
        }
    }










</script>

{% endblock content %}